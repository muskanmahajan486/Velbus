<?xml version="1.0" encoding="utf-8" ?>
<!--
 |  Build file for VELBUS Protocol
 |
 |  Author: Richard Turner
 +-->
<project name="VELBUS Protocol" default="jar" basedir=".">

	<property file = "build.properties"/>

	<!-- Some base dir used -->
	<property name="project.name" value="velbus-limited" />
	<property name="lib.dir" value="lib" />
	<property name="src.dir" value="src"/>
	<property name="test.dir" value="test"/>
	<property name="build.dir" value="bin"/>
	<property name="output.dir" value="output"/>
	<property name="jar.name" value="${project.name}-${version}.jar"/>
	
	<path id="project.class.path">
		<pathelement location="${build.dir}"/>
		<pathelement location="${lib.dir}/jdom-1.0.jar"/>
        <pathelement location="${lib.dir}/log4j/log4j-1.2.12.jar"/>
		<pathelement location="${controller.project.dir}/build/classes"/>
	</path>
	
	<target name="clean" description="deletes all generated files">
		<echo message="--------------------------------------------------------------------" />
		<echo message=" Clean..." />
		<echo message="--------------------------------------------------------------------" />
		<echo message="" />
		<delete dir="${build.dir}"/>
		<delete dir="${output.dir}"/>
	</target>
  
	<target name="init" depends="clean">
		<echo message="--------------------------------------------------------------------" />
		<echo message=" Initialising..." />
		<echo message="--------------------------------------------------------------------" />
		<echo message="" />
		<mkdir dir="${build.dir}"/>
		<mkdir dir="${output.dir}"/>
		<copy todir="${build.dir}">
            <fileset dir="${src.dir}">
                <exclude name="**/*.launch"/>
                <exclude name="**/*.java"/>
            </fileset>
		</copy>
	</target>
  
	<target name="javac" depends="init" description="Compile java source">
		<echo message="--------------------------------------------------------------------" />
		<echo message=" Compiling Java classes..." />
		<echo message="--------------------------------------------------------------------" />
		<echo message="" />
		<javac failonerror="true" srcdir="${src.dir}" destdir="${build.dir}" source="1.6" target="1.6" nowarn="true" debug="true" debuglevel="lines,vars,source">
			<classpath refid="project.class.path"/>
		</javac>
	</target>
  
	<target name="jar" depends="javac" description="Create a jar file">
		<echo message="--------------------------------------------------------------------" />
		<echo message=" Packing jar..." />
		<echo message="--------------------------------------------------------------------" />
		<echo message="" />
		<jar destfile="${output.dir}/${jar.name}" basedir="${build.dir}" />
	</target>
</project>